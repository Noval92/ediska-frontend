<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Form Mata Kuliah + Autocomplete + Sesi</title>
  <style>
    body { font-family: Arial; background: #f4f6f9; padding: 20px; }
    .container { max-width: 720px; margin: auto; background: white; padding: 30px;
      border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, select, textarea, button { width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; }

    /* autocomplete styles */
    .autocomplete { position: relative; }
    .autocomplete-items {
      position: absolute;
      border: 1px solid #d4d4d4;
      border-top: none;
      z-index: 99;
      top: 100%;
      left: 0; right: 0;
      background: #fff;
    }
    .autocomplete-items div {
      padding: 10px;
      cursor: pointer;
    }
    .autocomplete-items div:hover,
    .autocomplete-active {
      background: #e9e9e9;
    }

    /* sesi styles */
    .sesi-block { border: 1px solid #ccc; padding: 20px; margin-top: 20px;
      border-radius: 8px; background: #f9f9f9; }
    .hidden { display: none; }
    .riwayat { margin-top: 30px; background: #eef; padding: 15px; border-radius: 10px; }
  </style>
</head>
<body>
<div class="container">
  <h2>Input Mata Kuliah</h2>

  <label for="nama">Nama Mata Kuliah</label>
  <div class="autocomplete">
    <input id="nama" type="text" placeholder="Ketik nama matkulâ€¦" />
  </div>

  <label for="kode">Kode Mata Kuliah</label>
  <input id="kode" type="text" />

  <label for="sks">Jumlah SKS</label>
  <input id="sks" type="number" min="0" max="6" />

  <button id="addSesi" type="button" disabled>Tambah Sesi</button>

  <div id="sesiContainer"></div>

  <div class="riwayat">
    <h3>Riwayat Sesi</h3>
    <ul id="riwayatList"></ul>
  </div>
</div>

<script>
  // === 1) Daftar lengkap mata kuliah ===
  const courses = [
    { kode:'MATA4101', nama:'PENGANTAR MATEMATIKA',                        sks:3 },
    { kode:'MATA4110', nama:'KALKULUS I',                                  sks:3 },
    { kode:'MKWU4101', nama:'PENDIDIKAN AGAMA ISLAM',                      sks:3 },
    { kode:'MKWU4108', nama:'BAHASA INDONESIA',                            sks:3 },
    { kode:'MKWU4109', nama:'PENDIDIKAN KEWARGANEGARAAN',                  sks:3 },
    { kode:'MSIM4101', nama:'PENGANTAR SISTEM INFORMASI',                  sks:3 },
    { kode:'EKMA4111', nama:'PENGANTAR BISNIS',                            sks:3 },
    { kode:'EKMA4116', nama:'MANAJEMEN',                                   sks:4 },
    { kode:'MATA4112', nama:'ALJABAR LINEAR ELEMENTER I',                 sks:2 },
    { kode:'MKWI4201', nama:'BAHASA INGGRIS',                              sks:3 },
    { kode:'MSIM4103', nama:'LOGIKA INFORMATIKA',                         sks:3 },
    { kode:'SATS4111', nama:'KOMPUTER I',                                  sks:3 },
    { kode:'ADPU4341', nama:'TEORI ORGANISASI',                            sks:3 },
    { kode:'BING4102', nama:'READING I',                                   sks:3 },
    { kode:'EKMA4158', nama:'PERILAKU ORGANISASI',                        sks:3 },
    { kode:'MSIM4201', nama:'SISTEM OPERASI',                             sks:3 },
    { kode:'MSIM4202', nama:'STRUKTUR DATA',                              sks:3 },
    { kode:'SATS4121', nama:'METODE STATISTIK I',                         sks:3 },
    { kode:'MKWI4202', nama:'BELAJAR DI ERA DIGITAL',                     sks:3 },
    { kode:'MSIM4203', nama:'ALGORITMA DAN PEMROGRAMAN',                  sks:3 },
    { kode:'MSIM4204', nama:'JARINGAN KOMPUTER',                          sks:3 },
    { kode:'MSIM4205', nama:'PROSES BISNIS',                              sks:2 },
    { kode:'MSIM4206', nama:'BASIS DATA',                                 sks:3 },
    { kode:'MSIM4207', nama:'SISTEM INFORMASI MANAJEMEN',                 sks:3 },
    { kode:'MSIM4208', nama:'INTERAKSI MANUSIA DAN KOMPUTER',             sks:3 },
    { kode:'MSIM4301', nama:'PEMROGRAMAN BERBASIS DESKTOP',               sks:3 },
    { kode:'MSIM4302', nama:'ANALISIS DAN PERANCANGAN SISTEM',            sks:3 },
    { kode:'MSIM4303', nama:'REKAYASA PERANGKAT LUNAK',                   sks:3 },
    { kode:'MSIM4304', nama:'DASAR INFRASTRUKTUR TI',                     sks:2 },
    { kode:'MSIM4305', nama:'MANAJEMEN RESIKO DAN AUDIT SISTEM INFORMASI', sks:3 },
    { kode:'MSIM4306', nama:'KOMUNIKASI BISNIS DAN TEKNIS',               sks:2 },
    { kode:'MSIM4307', nama:'SISTEM PENDUKUNG KEPUTUSAN',                sks:3 },
    { kode:'MSIM4308', nama:'ADMINISTRASI SERVER',                       sks:3 },
    { kode:'LUHT4353', nama:'TEKNIK PENULISAN ILMIAH',                   sks:2 },
    { kode:'MSIM4309', nama:'PEMROGRAMAN BERBASIS WEB',                  sks:3 },
    { kode:'MSIM4310', nama:'ANALISIS DAN VISUALISASI DATA',             sks:2 },
    { kode:'MSIM4311', nama:'ARSITEKTUR DAN PERANCANGAN SISTEM ENTERPRISE', sks:3 },
    { kode:'MSIM4312', nama:'METODOLOGI PENELITIAN',                     sks:3 },
    { kode:'MSIM4315', nama:'DATA WAREHOUSE',                            sks:3 },
    { kode:'MSIM4316', nama:'ADMINISTRASI JARINGAN',                     sks:3 },
    { kode:'STSI4401', nama:'Capstone Project',                          sks:4 },
    { kode:'MKWI4203', nama:'KEWIRAUSAHAAN DI ERA DIGITAL',              sks:3 },
    { kode:'MSIM4401', nama:'PEMROGRAMAN BERBASIS PERANGKAT BERGERAK',   sks:3 },
    { kode:'MSIM4402', nama:'TATA KELOLA TEKNOLOGI INFORMASI',           sks:2 },
    { kode:'MSIM4403', nama:'DATA MINING',                               sks:3 },
    { kode:'MSIM4404', nama:'KEAMANAN JARINGAN',                         sks:3 },
    { kode:'MSIM4500', nama:'TUGAS AKHIR PROGRAM',                      sks:6 },
    { kode:'MSIM4560', nama:'KARYA ILMIAH',                              sks:0 },
    { kode:'EKMA4483', nama:'E-Business',                                sks:3 },
    { kode:'MKWU4110', nama:'PANCASILA',                                 sks:3 },
    { kode:'MSIM4405', nama:'KEAMANAN SISTEM INFORMASI',                 sks:2 },
    { kode:'MSIM4406', nama:'MANAJEMEN PROYEK SISTEM INFORMASI',        sks:2 },
    { kode:'MSIM4407', nama:'MANAJEMEN LAYANAN TEKNOLOGI INFORMASI',     sks:3 },
    { kode:'MSIM4408', nama:'ETIKA PROFESI',                            sks:2 }
  ];

  // === 2) custom autocomplete function ===
  function autocomplete(inp, items) {
    let currentFocus;
    inp.addEventListener("input", function(){
      const val = this.value;
      closeAllLists();
      if (!val) return false;
      currentFocus = -1;
      const list = document.createElement("div");
      list.setAttribute("class", "autocomplete-items");
      this.parentNode.appendChild(list);

      items.forEach(text => {
        if (text.substr(0, val.length).toUpperCase() === val.toUpperCase()) {
          const entry = document.createElement("div");
          entry.innerHTML = "<strong>" + text.substr(0, val.length) + "</strong>" + text.substr(val.length);
          entry.addEventListener("click", () => {
            inp.value = text;
            fillKodeSks(text);
            closeAllLists();
          });
          list.appendChild(entry);
        }
      });
    });

    inp.addEventListener("keydown", function(e) {
      let x = document.querySelector(".autocomplete-items");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode === 40) { currentFocus++; addActive(x); }
      else if (e.keyCode === 38) { currentFocus--; addActive(x); }
      else if (e.keyCode === 13) { 
        e.preventDefault();
        if (x && currentFocus > -1) x[currentFocus].click();
      }
    });

    function addActive(x) {
      if (!x) return false;
      removeActive(x);
      if (currentFocus >= x.length) currentFocus = 0;
      if (currentFocus < 0)    currentFocus = x.length - 1;
      x[currentFocus].classList.add("autocomplete-active");
    }
    function removeActive(x) {
      for (const el of x) el.classList.remove("autocomplete-active");
    }
    function closeAllLists(elmnt) {
      const lists = document.getElementsByClassName("autocomplete-items");
      for (const list of lists) {
        if (elmnt !== list && elmnt !== inp) list.parentNode.removeChild(list);
      }
    }
    document.addEventListener("click", e => closeAllLists(e.target));
  }

  function fillKodeSks(namaMtkl) {
    const m = courses.find(c => c.nama === namaMtkl);
    if (m) {
      document.getElementById("kode").value = m.kode;
      document.getElementById("sks").value  = m.sks;
      document.getElementById("addSesi").disabled = false;
    }
  }

  // inisialisasi autocomplete
  autocomplete(document.getElementById("nama"), courses.map(c => c.nama));

  // === 3) kode sesi & riwayat (sama seperti sebelumnya) ===
  let sesiIndex = 1, riwayat = [];

  function createSesiBlock(i) {
    const div = document.createElement("div");
    div.className = 'sesi-block'; div.id = `sesi${i}`;
    div.innerHTML = `
      <h3>Sesi ${i} - Nama Matkulnya apa?</h3>
      <label>1. Hal apa yang dipelajari?</label>
      <textarea id="belajar${i}" required></textarea>
      <label>2. Apakah ada materi yang mau diupload?</label>
      <select id="materiSelect${i}">
        <option value="tidak">Tidak</option><option value="ya">Ya</option>
      </select>
      <input type="file" id="materi${i}" class="hidden" accept="application/pdf,image/*">
      <label>3. Apakah ada file lain yang mau diupload?</label>
      <select id="lainSelect${i}">
        <option value="tidak">Tidak</option><option value="ya">Ya</option>
      </select>
      <div id="lainFile${i}" class="hidden">
        <label>Upload Ringkasan</label><input type="file" id="ringkasan${i}" accept="application/pdf,image/*">
        <label>Upload Soal Diskusi dan Jawaban</label><input type="file" id="diskusi${i}" accept="application/pdf,image/*">
        <label>Upload Tugas</label><input type="file" id="tugas${i}" accept="application/pdf,image/*">
      </div>
      <label>4. Apakah sudah ada nilai?</label>
      <select id="nilaiSelect${i}">
        <option value="tidak">Tidak</option><option value="ya">Ya</option>
      </select>
      <input type="number" id="nilai${i}" class="hidden" min="0" max="100">
      <button type="button" onclick="simpanSesi(${i}, this)">Simpan Sesi ${i}</button>
    `;
    return div;
  }

  function simpanSesi(i, btn) {
    if (riwayat.includes(i)) return alert("Sesi ini sudah disimpan.");
    riwayat.push(i);
    document.getElementById('riwayatList').innerHTML += `<li>Sesi ${i} disimpan</li>`;
    btn.disabled = true;
    document.getElementById('addSesi').disabled = false;
  }

  document.getElementById('addSesi').addEventListener('click', () => {
    sesiIndex++;
    document.getElementById('addSesi').disabled = true;
    const sb = createSesiBlock(sesiIndex);
    document.getElementById('sesiContainer').appendChild(sb);
    attachHandlers(sesiIndex);
  });

  function attachHandlers(i) {
    document.getElementById(`materiSelect${i}`)
      .addEventListener('change', e =>
        document.getElementById(`materi${i}`).classList.toggle('hidden', e.target.value==='tidak'));

    document.getElementById(`lainSelect${i}`)
      .addEventListener('change', e =>
        document.getElementById(`lainFile${i}`).classList.toggle('hidden', e.target.value==='tidak'));

    document.getElementById(`nilaiSelect${i}`)
      .addEventListener('change', e =>
        document.getElementById(`nilai${i}`).classList.toggle('hidden', e.target.value==='tidak'));
  }

  // load sesi 1
  const awal = createSesiBlock(1);
  document.getElementById('sesiContainer').appendChild(awal);
  attachHandlers(1);
</script>
</body>
</html>
